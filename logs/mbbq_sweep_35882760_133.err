/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/transformers/utils/hub.py:110: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
`torch_dtype` is deprecated! Use `dtype` instead!
[1;36m(EngineCore_DP0 pid=29910)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=29910)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=29910)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=29910)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/v1/engine/core.py", line 712, in run_engine_core
[1;36m(EngineCore_DP0 pid=29910)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/v1/engine/core.py", line 699, in run_engine_core
[1;36m(EngineCore_DP0 pid=29910)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/v1/engine/core.py", line 498, in __init__
[1;36m(EngineCore_DP0 pid=29910)[0;0m     super().__init__(vllm_config, executor_class, log_stats,
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/v1/engine/core.py", line 83, in __init__
[1;36m(EngineCore_DP0 pid=29910)[0;0m     self.model_executor = executor_class(vllm_config)
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/executor/executor_base.py", line 54, in __init__
[1;36m(EngineCore_DP0 pid=29910)[0;0m     self._init_executor()
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/executor/uniproc_executor.py", line 55, in _init_executor
[1;36m(EngineCore_DP0 pid=29910)[0;0m     self.collective_rpc("load_model")
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/executor/uniproc_executor.py", line 83, in collective_rpc
[1;36m(EngineCore_DP0 pid=29910)[0;0m     return [run_method(self.driver_worker, method, args, kwargs)]
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/utils/__init__.py", line 3122, in run_method
[1;36m(EngineCore_DP0 pid=29910)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/v1/worker/gpu_worker.py", line 213, in load_model
[1;36m(EngineCore_DP0 pid=29910)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/v1/worker/gpu_model_runner.py", line 2635, in load_model
[1;36m(EngineCore_DP0 pid=29910)[0;0m     self.model = model_loader.load_model(
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/model_executor/model_loader/base_loader.py", line 50, in load_model
[1;36m(EngineCore_DP0 pid=29910)[0;0m     self.load_weights(model, model_config)
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/model_executor/model_loader/default_loader.py", line 264, in load_weights
[1;36m(EngineCore_DP0 pid=29910)[0;0m     loaded_weights = model.load_weights(
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/model_executor/models/llama.py", line 615, in load_weights
[1;36m(EngineCore_DP0 pid=29910)[0;0m     return loader.load_weights(
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/model_executor/models/utils.py", line 294, in load_weights
[1;36m(EngineCore_DP0 pid=29910)[0;0m     autoloaded_weights = set(self._load_module("", self.module, weights))
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/model_executor/models/utils.py", line 243, in _load_module
[1;36m(EngineCore_DP0 pid=29910)[0;0m     for child_prefix, child_weights in self._groupby_prefix(weights):
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/model_executor/models/utils.py", line 132, in _groupby_prefix
[1;36m(EngineCore_DP0 pid=29910)[0;0m     for prefix, group in itertools.groupby(weights_by_parts,
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/model_executor/models/utils.py", line 129, in <genexpr>
[1;36m(EngineCore_DP0 pid=29910)[0;0m     weights_by_parts = ((weight_name.split(".", 1), weight_data)
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/model_executor/models/utils.py", line 291, in <genexpr>
[1;36m(EngineCore_DP0 pid=29910)[0;0m     weights = ((name, weight) for name, weight in weights
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/model_executor/models/llama.py", line 615, in <genexpr>
[1;36m(EngineCore_DP0 pid=29910)[0;0m     return loader.load_weights(
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/model_executor/model_loader/default_loader.py", line 246, in get_all_weights
[1;36m(EngineCore_DP0 pid=29910)[0;0m     yield from self._get_weights_iterator(primary_weights)
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/model_executor/model_loader/default_loader.py", line 160, in _get_weights_iterator
[1;36m(EngineCore_DP0 pid=29910)[0;0m     hf_folder, hf_weights_files, use_safetensors = self._prepare_weights(
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/model_executor/model_loader/default_loader.py", line 112, in _prepare_weights
[1;36m(EngineCore_DP0 pid=29910)[0;0m     hf_folder = download_weights_from_hf(
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/model_executor/model_loader/weight_utils.py", line 398, in download_weights_from_hf
[1;36m(EngineCore_DP0 pid=29910)[0;0m     hf_folder = snapshot_download(
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
[1;36m(EngineCore_DP0 pid=29910)[0;0m     return fn(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/huggingface_hub/_snapshot_download.py", line 332, in snapshot_download
[1;36m(EngineCore_DP0 pid=29910)[0;0m     thread_map(
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/tqdm/contrib/concurrent.py", line 69, in thread_map
[1;36m(EngineCore_DP0 pid=29910)[0;0m     return _executor_map(ThreadPoolExecutor, fn, *iterables, **tqdm_kwargs)
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/tqdm/contrib/concurrent.py", line 51, in _executor_map
[1;36m(EngineCore_DP0 pid=29910)[0;0m     return list(tqdm_class(ex.map(fn, *iterables, chunksize=chunksize), **kwargs))
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/tqdm/std.py", line 1169, in __iter__
[1;36m(EngineCore_DP0 pid=29910)[0;0m     for obj in iterable:
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/concurrent/futures/_base.py", line 621, in result_iterator
[1;36m(EngineCore_DP0 pid=29910)[0;0m     yield _result_or_cancel(fs.pop())
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/concurrent/futures/_base.py", line 319, in _result_or_cancel
[1;36m(EngineCore_DP0 pid=29910)[0;0m     return fut.result(timeout)
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/concurrent/futures/_base.py", line 458, in result
[1;36m(EngineCore_DP0 pid=29910)[0;0m     return self.__get_result()
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
[1;36m(EngineCore_DP0 pid=29910)[0;0m     raise self._exception
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/concurrent/futures/thread.py", line 58, in run
[1;36m(EngineCore_DP0 pid=29910)[0;0m     result = self.fn(*self.args, **self.kwargs)
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/huggingface_hub/_snapshot_download.py", line 306, in _inner_hf_hub_download
[1;36m(EngineCore_DP0 pid=29910)[0;0m     return hf_hub_download(
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
[1;36m(EngineCore_DP0 pid=29910)[0;0m     return fn(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1007, in hf_hub_download
[1;36m(EngineCore_DP0 pid=29910)[0;0m     return _hf_hub_download_to_cache_dir(
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1168, in _hf_hub_download_to_cache_dir
[1;36m(EngineCore_DP0 pid=29910)[0;0m     _download_to_tmp_and_move(
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1720, in _download_to_tmp_and_move
[1;36m(EngineCore_DP0 pid=29910)[0;0m     xet_get(
[1;36m(EngineCore_DP0 pid=29910)[0;0m   File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 626, in xet_get
[1;36m(EngineCore_DP0 pid=29910)[0;0m     download_files(
[1;36m(EngineCore_DP0 pid=29910)[0;0m RuntimeError: Data processing error: CAS service error : ReqwestMiddleware Error: couldn't get token: TokenRefreshFailure("Error refreshing token: PyErr { type: <class 'requests.exceptions.ConnectionError'>, value: ConnectionError(ProtocolError('Connection aborted.', RemoteDisconnected('Remote end closed connection without response')), '(Request ID: 0bc9262e-77ea-45ae-8c45-ea9a8381a48b)'), traceback: Some(\"Traceback (most recent call last):\\n  File \\\"/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/huggingface_hub/file_download.py\\\", line 594, in token_refresher\\n    connection_info = refresh_xet_connection_info(file_data=xet_file_data, headers=headers)\\n  File \\\"/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py\\\", line 114, in _inner_fn\\n    return fn(*args, **kwargs)\\n  File \\\"/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/huggingface_hub/utils/_xet.py\\\", line 116, in refresh_xet_connection_info\\n    return _fetch_xet_connection_info_with_url(file_data.refresh_route, headers)\\n  File \\\"/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py\\\", line 114, in _inner_fn\\n    return fn(*args, **kwargs)\\n  File \\\"/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/huggingface_hub/utils/_xet.py\\\", line 186, in _fetch_xet_connection_info_with_url\\n    resp = get_session().get(headers=headers, url=url, params=params)\\n  File \\\"/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/requests/sessions.py\\\", line 602, in get\\n    return self.request(\\\"GET\\\", url, **kwargs)\\n  File \\\"/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/requests/sessions.py\\\", line 589, in request\\n    resp = self.send(prep, **send_kwargs)\\n  File \\\"/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/requests/sessions.py\\\", line 703, in send\\n    r = adapter.send(request, **kwargs)\\n  File \\\"/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/huggingface_hub/utils/_http.py\\\", line 95, in send\\n    return super().send(request, *args, **kwargs)\\n  File \\\"/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/requests/adapters.py\\\", line 659, in send\\n    raise ConnectionError(err, request=request)\\n\") }")
Traceback (most recent call last):
  File "/jet/home/pgoyal2/Reasoning-Bias/src/main.py", line 255, in <module>
    run_evaluation(args)
  File "/jet/home/pgoyal2/Reasoning-Bias/src/main.py", line 173, in run_evaluation
    evaluator = load_evaluator(args)
  File "/jet/home/pgoyal2/Reasoning-Bias/src/main.py", line 136, in load_evaluator
    evaluator = ReasoningEvaluator(
  File "/jet/home/pgoyal2/Reasoning-Bias/src/evaluators/reasoning_eval.py", line 35, in __init__
    self.model = LLM(
  File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/entrypoints/llm.py", line 297, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
  File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/v1/engine/llm_engine.py", line 177, in from_engine_args
    return cls(vllm_config=vllm_config,
  File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/v1/engine/llm_engine.py", line 114, in __init__
    self.engine_core = EngineCoreClient.make_client(
  File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/v1/engine/core_client.py", line 80, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
  File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/v1/engine/core_client.py", line 602, in __init__
    super().__init__(
  File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/v1/engine/core_client.py", line 448, in __init__
    with launch_core_engines(vllm_config, executor_class,
  File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/contextlib.py", line 142, in __exit__
    next(self.gen)
  File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/v1/engine/utils.py", line 732, in launch_core_engines
    wait_for_engine_startup(
  File "/ocean/projects/cis250182p/pgoyal2/conda_envs/MBBQEnv/lib/python3.10/site-packages/vllm/v1/engine/utils.py", line 785, in wait_for_engine_startup
    raise RuntimeError("Engine core initialization failed. "
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}
